parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"G+iF":[function(require,module,exports) {
var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},t=function(){return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return function(r,t){var e=[],n=!0,o=!1,i=void 0;try{for(var u,f=r[Symbol.iterator]();!(n=(u=f.next()).done)&&(e.push(u.value),!t||e.length!==t);n=!0);}catch(r){o=!0,i=r}finally{try{!n&&f.return&&f.return()}finally{if(o)throw i}}return e}(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),e=!1,n=function(){var r={};return function(e,n,o,i){var u=JSON.stringify(i);if("string"!=typeof e)return o;var f=n[e];if(!Number.isInteger(f))return o;if(!r[u])return r[u]=[1,f],f;var a=t(r[u],2),y=a[0],c=(y*a[1]+f)/(y+1);return r[u]=[y+1,c],c}}();function o(r,t,e){if(e)return e;var n=t[r];return void 0===n?e:n}var i=function(r,t){return t[r]},u=p("max"),f=p("min");function a(r,t,n){if(n=Number.isInteger(n)?n:0,1===r)return n+1;if("string"==typeof r){var o=t[r];return"number"!=typeof o?n:n+o}if(e)throw new SyntaxError("Invalid target.")}function y(r,t,n){if(!r.length&&e)throw new TypeError("$push expects an array of fields (string).");var o=r.reduce(function(r,e){return r[e]=t[e],r},{});return n?(n.push(o),n):[o]}function c(r,t,n){if("string"!=typeof r&&e)throw TypeError("$addToSet expects a field (string).");var o=t[r];return n?(-1===n.indexOf(o)&&n.push(o),n):[o]}function p(r){return function(t,e,n){if("string"!=typeof t)return n;var o=e[t];return Number.isInteger(o)?("min"===r?n<o:n>o)?n:o:n}}var s={$avg:n,$first:o,$last:i,$max:u,$min:f,$sum:a,$push:y,$addToSet:c};function l(t){var n=t.operatorObj,o=t.record,i=t.currentValue,u=t.groupId;if("object"!==(void 0===n?"undefined":r(n))&&e)throw TypeError("Expected a value/key pair.");var f=Object.keys(n);if(f.length>1&&e)throw SyntaxError("Only 1 operator per field is supported.");var a=f[0],y=n[a];if(-1===Object.keys(s).indexOf(a)&&e)throw SyntaxError("Invalid operator.");return s[a](y,o,i,u)}module.exports=l;
},{}],"71rA":[function(require,module,exports) {
function e(e){var t=[];for(var o in e)t.push(o);return t}exports=module.exports="function"==typeof Object.keys?Object.keys:e,exports.shim=e;
},{}],"jM21":[function(require,module,exports) {
var t="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function e(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function o(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}exports=module.exports=t?e:o,exports.supported=e,exports.unsupported=o;
},{}],"LAt+":[function(require,module,exports) {
var t=Array.prototype.slice,e=require("./lib/keys.js"),r=require("./lib/is_arguments.js"),n=module.exports=function(t,e,r){return r||(r={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?r.strict?t===e:t==e:i(t,e,r))};function o(t){return null==t}function f(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}function i(i,u,l){var c,p;if(o(i)||o(u))return!1;if(i.prototype!==u.prototype)return!1;if(r(i))return!!r(u)&&(i=t.call(i),u=t.call(u),n(i,u,l));if(f(i)){if(!f(u))return!1;if(i.length!==u.length)return!1;for(c=0;c<i.length;c++)if(i[c]!==u[c])return!1;return!0}try{var y=e(i),s=e(u)}catch(t){return!1}if(y.length!=s.length)return!1;for(y.sort(),s.sort(),c=y.length-1;c>=0;c--)if(y[c]!=s[c])return!1;for(c=y.length-1;c>=0;c--)if(p=y[c],!n(i[p],u[p],l))return!1;return typeof i==typeof u}
},{"./lib/keys.js":"71rA","./lib/is_arguments.js":"jM21"}],"J6HI":[function(require,module,exports) {
var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},t=require("deep-equal");function e(r,t){if("string"==typeof r){var e=t[r];if("string"!=typeof e&&"number"!=typeof e)throw TypeError('Only types "string" and "number" are supported for group ids.');return e}if(Array.isArray(r))return r.reduce(function(r,e){return r[e]=t[e],r},{})}function n(r,t){var e=void 0;return Object.keys(r).length?e=t.findIndex(function(t){var e=!0,n=!1,o=void 0;try{for(var i,u=Object.keys(t.id)[Symbol.iterator]();!(e=(i=u.next()).done);e=!0){var f=i.value;if(r[f]!==t.id[f])return!1}}catch(r){n=!0,o=r}finally{try{!e&&u.return&&u.return()}finally{if(n)throw o}}return!0}):"string"==typeof r&&(e=t.findIndex(function(t){return t.id===r})),-1===e?{id:r}:t.splice(e,1)[0]}function o(e,n){if("string"==typeof e)-1===n.indexOf(e)&&n.push(e);else if("object"===(void 0===e?"undefined":r(e))){var o=!1,i=!0,u=!1,f=void 0;try{for(var y,a=n[Symbol.iterator]();!(i=(y=a.next()).done);i=!0){var d=y.value;if(t(e,d.id)){o=!0;break}}}catch(r){u=!0,f=r}finally{try{!i&&a.return&&a.return()}finally{if(u)throw f}}n.length&&o||n.push({id:e})}return n}module.exports={getGroupId:e,getGroup:n,getGroupKeys:o};
},{"deep-equal":"LAt+"}],"zJqv":[function(require,module,exports) {
var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,r){for(var e=0;e<r.length;e++){var a=r[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(r,e,a){return e&&t(r.prototype,e),a&&t(r,a),r}}();function e(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function a(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}var i=require("./operators"),n=require("./helpers"),o=n.getGroupId,u=n.getGroup,s=n.getGroupKeys,c=!1,f=function(){function n(t){a(this,n);try{this.data=this.cache=JSON.parse(t)}catch(t){if(c)throw TypeError("Could not parse JSON.");this.data=this.cache=[{}]}this.data.length||(this.data=[this.data])}return r(n,[{key:"match",value:function(r){if("function"==typeof r)this.data=this.data.filter(r);else if("object"===(void 0===r?"undefined":t(r))){var e=Object.keys(r);this.data=this.data.reduce(function(t,a){var i=!0,n=!1,o=void 0;try{for(var u,s=e[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;if(a[c]!==r[c])return t}}catch(t){n=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(n)throw o}}return t.push(a),t},[])}else if(c)throw TypeError("match :: expects an object or a condition function.");return this}},{key:"unwind",value:function(t){var r=[];return this.data.forEach(function(a){var i=a[t];i&&i.length?i.forEach(function(i){var n=Object.assign({},a,e({},t,i));r.push(n)}):r.push(a)}),this.data=r,this}},{key:"group",value:function(t){var r=void 0;if("string"==typeof t||Array.isArray(t))r=t;else if(-1!==Object.keys(t).indexOf("id"))r=t.id,delete t.id;else if(c)throw Error("group :: an id field is required.");return"string"==typeof t||Array.isArray(t)||0===Object.keys(t).length?(this.data=this.data.reduce(function(t,e){var a=o(r,e);return s(a,t)},[]),this):"string"==typeof r||Array.isArray(r)?(this.data=this.data.reduce(function(e,a){var n=Object.keys(t),s=o(r,a);if(void 0===s)return e;var c=u(s,e),f=!0,l=!1,h=void 0;try{for(var y,d=n[Symbol.iterator]();!(f=(y=d.next()).done);f=!0){var v=y.value;c[v]=i({operatorObj:t[v],currentValue:c[v],groupId:s,record:a})}}catch(t){l=!0,h=t}finally{try{!f&&d.return&&d.return()}finally{if(l)throw h}}return e.push(c),e},[]),this):void 0}},{key:"sort",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=!0,a=!1,i=void 0;try{for(var n,o=Object.keys(t)[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var u=n.value,s=t[u];if(!Number.isInteger(s)||1!==Math.abs(s))throw SyntaxError("sort :: criteria need to use either 1 or -1.")}}catch(t){a=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(a)throw i}}var c=Object.keys(t);return this.data=this.data.sort(r||function r(e,a){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=c[i],o=t[n];return e[n]<a[n]?-1*o:e[n]>a[n]?1*o:r(e,a,i+1)}),this}},{key:"limit",value:function(t){return this.data=this.data.slice(0,t),this}},{key:"exec",value:function(){var t=this.data;return this.data=this.cache,t}}]),n}();module.exports=f;
},{"./operators":"G+iF","./helpers":"J6HI"}],"Focm":[function(require,module,exports) {
var e=require("./lib/Collection");module.exports={Collection:e};
},{"./lib/Collection":"zJqv"}]},{},["Focm"], null)
//# sourceMappingURL=/json-aggregate.map